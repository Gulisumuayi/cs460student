<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CS461 – A2 Hello Cube</title>
  <style>html,body{margin:0;height:100%;background:#000;color:#ddd}</style>
  <!-- XTK from CDN -->
  <script src="https://get.goXTK.com/xtk_edge.js"></script>
</head>
<body>
  <div id="ok" style="position:fixed;left:10px;top:10px">loaded…</div>
<script>
  var r = new X.renderer3D();
  r.init();
  r.camera.position = [0, 0, 300];

  // 11×11×11 = 1331 cubes
  const SIZE=6, GAP=2; function pos(n){ return (SIZE+GAP)*n; }
  for (let z=-5; z<=5; z++){
    for (let y=-5; y<=5; y++){
      for (let x=-5; x<=5; x++){
        const c = new X.cube();
        c.lengthX=c.lengthY=c.lengthZ=SIZE;
        c.transform.translateX(pos(x));
        c.transform.translateY(pos(y));
        c.transform.translateZ(pos(z));
        c.color=[0.3+0.7*Math.random(),0.3+0.7*Math.random(),0.3+0.7*Math.random()];
        r.add(c);
      }
    }
  }

  // picking (hover)
  var SELECTED = null;
  r.interactor.onMouseMove = function(e){
    const id = r.pick(e.offsetX, e.offsetY);
    SELECTED = (id && id !== 0) ? r.get(id) : null;
  };

  // keys
  let SPIN=false;
  window.onkeypress = function(ev){
    const k = ev.key.toLowerCase();
    if (k==='b'){ SPIN=!SPIN; return; }
    if (k==='o'){ if (typeof download==='function') download(); return; }
    if (k==='l'){ if (typeof upload==='function') upload('scene.json'); return; }
    if (!SELECTED) return;
    if (k==='q') SELECTED.visible=false;
    if (k==='w') SELECTED.color=[Math.random(),Math.random(),Math.random()];
    if (k==='e') SELECTED.transform.rotateX(10);
  };

  r.onRender = function(){ if (SPIN) r.camera.rotate([1,0]); };
  r.render();
</script>
<!-- Keep this if you already added it -->
<script src="loader.js"></script>
</body>
</html>
